<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Formas Psicodélicas - Controle de Cor e Velocidade</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #fff;
      color: #111;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      background: #222;
      padding: 10px 0;
      text-align: center;
    }
    header a {
      color: #ccc;
      margin: 0 12px;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.2rem;
      transition: color 0.3s ease;
      user-select: none;
    }
    header a:hover {
      color: #00aaff;
    }
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #fff;
      position: relative;
      overflow: hidden;
    }
    #forma {
      width: 200px;
      height: 200px;
      margin: auto;
      transition: all 1s ease;
    }
    #controle {
      background: #222;
      color: #fff;
      padding: 15px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      user-select: none;
    }
    button {
      background: #000;
      color: #fff;
      border: 2px solid #00aaff;
      padding: 8px 16px;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    button:hover {
      background: #00aaff;
      color: #000;
    }
    label {
      font-size: 1rem;
      margin-right: 8px;
    }
    input[type="range"] {
      -webkit-appearance: none;
      width: 150px;
      height: 6px;
      background: #555;
      border-radius: 5px;
      outline: none;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 22px;
      height: 22px;
      background: #00aaff;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      margin-top: -8px;
      transition: background-color 0.3s ease;
    }
    input[type="range"]:hover::-webkit-slider-thumb {
      background: #0088cc;
    }
    /* For Firefox */
    input[type="range"]::-moz-range-thumb {
      width: 22px;
      height: 22px;
      background: #00aaff;
      border-radius: 50%;
      cursor: pointer;
      border: none;
      transition: background-color 0.3s ease;
    }
    input[type="range"]:hover::-moz-range-thumb {
      background: #0088cc;
    }
  </style>
</head>
<body>

<header>
  <a href="index.html">1</a>
  <a href="index2.html">2</a>
  <a href="index3.html">3</a>
  <a href="index4.html">4</a>
  href="index8.html">7</a>
</header>

<main>
  <svg id="forma" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"></svg>
</main>

<div id="controle">
  <button id="btnColorido" aria-pressed="true">Modo Colorido</button>
  <button id="btnPB" aria-pressed="false">Modo P&B</button>
  <label for="velocidade">Velocidade:</label>
  <input type="range" id="velocidade" min="1" max="10" value="3" aria-valuemin="1" aria-valuemax="10" aria-valuenow="3" />
</div>

<script>
  const svg = document.getElementById('forma');
  const btnColorido = document.getElementById('btnColorido');
  const btnPB = document.getElementById('btnPB');
  const sliderVelocidade = document.getElementById('velocidade');

  let modoColorido = true;
  let velocidade = 3; // vezes
  let animFrameId;
  let t = 0;

  // Formas geométricas para usar no SVG
  const formas = [
    // Círculo
    () => `<circle cx="50" cy="50" r="40" />`,
    // Quadrado
    () => `<rect x="20" y="20" width="60" height="60" rx="8" ry="8" />`,
    // Triângulo
    () => `<polygon points="50,15 85,85 15,85" />`,
    // Losango
    () => `<polygon points="50,10 90,50 50,90 10,50" />`,
    // Estrela
    () => `<polygon points="50,15 61,39 87,39 66,57 74,83 50,68 26,83 34,57 13,39 39,39" />`,
    // Coração
    () => `<path d="M50 80 L15 45 A15 15 0 1 1 50 20 A15 15 0 1 1 85 45 Z" />`,
  ];

  // Cores para modo colorido - base RGB psicodélico
  const coresColorido = [
    '#FF0054',
    '#00FF94',
    '#5400FF',
    '#FFAA00',
    '#00FFFF',
    '#FF00D8',
  ];

  // Cores para modo P&B
  const coresPB = ['#000', '#fff'];

  // Função para interpolar cores RGB entre dois hex, usando parâmetro 0 a 1
  function lerpColor(a, b, t) {
    const c1 = hexToRgb(a);
    const c2 = hexToRgb(b);
    return `rgb(${Math.round(c1.r + (c2.r - c1.r) * t)},${Math.round(c1.g + (c2.g - c1.g) * t)},${Math.round(c1.b + (c2.b - c1.b) * t)})`;
  }
  function hexToRgb(hex) {
    const h = hex.replace('#', '');
    return {
      r: parseInt(h.substring(0, 2), 16),
      g: parseInt(h.substring(2, 4), 16),
      b: parseInt(h.substring(4, 6), 16),
    };
  }

  // Variáveis de animação para cores e formas
  let currentFormaIndex = 0;
  let nextFormaIndex = 1;
  let colorInterpT = 0;

  // Atualiza a forma e a cor com animação suave
  function animar() {
    // Incrementa tempo conforme velocidade
    t += 0.01 * velocidade;

    // Atualiza interpolação de cor
    colorInterpT += 0.01 * velocidade;
    if (colorInterpT > 1) {
      colorInterpT = 0;
      currentFormaIndex = nextFormaIndex;
      nextFormaIndex = (nextFormaIndex + 1) % formas.length;
    }

    // Obtem formas SVG atuais
    const formaAtual = formas[currentFormaIndex]();
    const formaProx = formas[nextFormaIndex]();

    // Interpola cor para o modo selecionado
    let cor1, cor2, corInterp;
    if (modoColorido) {
      cor1 = coresColorido[currentFormaIndex % coresColorido.length];
      cor2 = coresColorido[nextFormaIndex % coresColorido.length];
      corInterp = lerpColor(cor1, cor2, colorInterpT);
    } else {
      // Preto e branco alterna conforme t
      corInterp = colorInterpT < 0.5 ? coresPB[0] : coresPB[1];
    }

    // Monta SVG com forma atual, usando opacidade para transição suave
    svg.innerHTML = `
      <g fill="${corInterp}" stroke="${corInterp}" stroke-width="3" style="transition: fill 0.3s ease, stroke 0.3s ease;">
        ${formaAtual}
      </g>
    `;

    animFrameId = requestAnimationFrame(animar);
  }

  // Inicia animação automática
  animar();

  // Eventos dos botões e slider
  btnColorido.addEventListener('click', () => {
    modoColorido = true;
    btnColorido.setAttribute('aria-pressed', 'true');
    btnPB.setAttribute('aria-pressed', 'false');
  });

  btnPB.addEventListener('click', () => {
    modoColorido = false;
    btnColorido.setAttribute('aria-pressed', 'false');
    btnPB.setAttribute('aria-pressed', 'true');
  });

  sliderVelocidade.addEventListener('input', (e) => {
    velocidade = parseInt(e.target.value, 10);
    sliderVelocidade.setAttribute('aria-valuenow', velocidade);
  });
</script>

</body>
</html>
